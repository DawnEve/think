基于web的测序结果管理系统v1.0
操作说明书
王军亮(15890149335)
JimmyMall@163.com
目录
一、系统说明	3
1.1关于本系统	3
1.2版权声明	3
1.3 系统功能	3
1.4获取帮助	4
1.5关于作者	4
二、安装与配置	5
2.1 环境配置	5
2.2 代码安装	5
2.3 数据库设计	6
2.4 数据库配置	7
2.5 网址配置	8
三、超级管理员操作说明书	9
3.1 首次登录	9
3.2 查看管理员	10
3.3 添加管理员	10
3.4 查看权限	11
3.5 查看角色	11
3.6 分配权限	12
3.7 添加权限	12
3.8 退出系统	13
四、教授角色操作说明书	14
4.1教授用户登录	14
4.2 添加用户	14
4.3 重置用户密码	15
4.4 添加冰箱	15
五、研究生角色操作说明书	17
5.1 研究生登录	17
5.2 添加盒子	17
5.3 添加分类	18
5.4 添加标签	18
5.5 添加引物	19
5.6 按照分类和标签索引引物	20
5.7 添加测序结果	21
5.8 按照分类和标签索引测序结果	22
5.9 添加文件	22
5.10 搜索	23
5.10.1 搜索入口	23
5.10.2 搜索方法	24
5.10.3按照关键词搜索	24
5.10.3 按照分类索引	24
5.10.4 按照标签索引	25
5.10.5 按照序列搜索	25
5.11 修改自己的密码	26
5.12 回收站	26




 
一、系统说明
1.1关于本系统
目的：本系统是基于web的测序结果管理系统，实现了测序信息的保存、分类、检索、追踪实物的功能。部分实现了生物实验室DNA样品的数字化管理。

功能：本系统包含如下功能模块：权限管理、地址管理、核心信息管理三个主要模块。
•	权限管理模块: 实现了基于rbac的系统权限管理，系统包括教授、研究生、本科生三个角色。并且具有可配置性。
•	地址管理模块: 包括冰箱管理、盒子管理。
•	核心信息管理模块: 包括测序序列管理、引物管理、文件管理。
•	信息检索模块: 包括分类管理、标签管理、关键词搜索等。
•	回收站模块:防止重要文件误删.
后台技术实现：本系统基于thinkPHP3.2框架开发，采用PHP5.5.1后台语言和MySQL Ver 14.14数据库实现主要功能。
前台技术实现：前台采用html、css、JavaScript实现。部分页面引用jQuery3.1.0使用ajax技术以提升用户体验。
由于时间仓促，本系统没有在更多浏览器及移动端做测试和兼容处理。为了更一致的体验，建议您使用chrome、firefox等现代浏览器登录和使用本系统。

1.2版权声明
声明：本系统受到郑州大学2015年研究生创新项目资助。保留所有权利。
开源地址：本系统在github上开源(http://www.github.com/dawneve/think/)，并持续更新。
意见与建议：如有任何问题或建议，欢迎在线提交issue。
授权：您可以自由的下载和研究本系统的代码及内在逻辑，但是应用本系统、再次编译and/or发布本系统需要保留作者署名，并获得授权许可。
没有获取授权的用户不受任何明示或者暗示的保证和担保。授权使用事宜请联系我们。

1.3 系统功能
本系统用户管理采用基于角色的访问控制(RBAC)，用户分为教授、研究生、本科生三个角色，教授可以添加用户、创建冰箱，研究生、本科生可以使用该系统记录、检索、追踪测序、引物、文件信息。
使用该系统时，需要请教授先创建用户，之后该用户凭借用户名和密码登录后使用。

1.	创建用户: 实验室教授负责创建用户，设置密码。一个系统内用户名不能重名。
2.	设置角色: 实验室教授可以指定用户的角色，角色分为教授、研究生、本科生三类角色。
3.	修改自己的密码：登录系统后，点击顶部 修改口令 可以修改自己的密码。
4.	创建冰箱: 教授负责创建冰箱，而研究生用户无法创建冰箱。系统内冰箱不能重名。
5.	创建盒子: 用户在冰箱中创建盒子。一个用户的盒子不能重名。
6.	创建分类: 分类可以方便的对测序、引物、文件进行分类，一个条目可以有1个分类。一个用户的分类不能重名。
7.	创建标签: 标签可以方便的对测序、引物、文件进行分类，一个条目可以有0-5个标签。一个用户的标签不能重名。
8.	创建引物: 引物就是自己合成引物的信息，或者测序中使用到的引物的信息。一个用户的引物不能重名。
9.	创建测序: 测序就是自己测序的信息。一个用户的测序名字不能重名。
10.	创建文件: 文件可以使附加在引物或者测序中的附件，或者是独立的非附件的文件。一个用户的文件名字可以重名，仅靠id区分。
11.	回收站: 除非特别提醒，本系统数据一般是删除到回收站，可以到回收站恢复数据，或者彻底删除。
12.	搜索: 本系统实现内部搜索，可以按照分类、标签、关键词、序列搜索，分别检索测序结果、引物、文件等。方便了文件的查找。

1.4获取帮助
如果遇到问题或者意外，请联系我们。

1.5关于作者
王军亮，郑州大学生命科学学院2014级硕士研究生。
Email: JimmyMall@163.com
phone: 15890149335


 
二、安装与配置
安装
本系统用于保存测序结果、引物等信息。包含了测序信息、保存地点、检索等基本功能。
本系统适合于实验室局域网内部使用。不登陆无法查看任何资料，保证了系统的安全性。
本系统需要由专业人员安装，包括(1)数据库配置和导入,(2)网络环境配置和框架搭建，系统配置,(3)用户初始化配置和培训等部分。

2.1 环境配置
本系统基于thinkPHP3.2框架开发，开发测试使用win7系统，安装PHP5.5.1和MySQL Ver 14.14数据库。
2.2 代码安装
下载github上代码,复制SeqManager目录中的内容到web根目录,目录结构如下:
 
其中要在Public下新建Uploads文件夹,作为附件上传的文件夹根目录.上传文件默认是按照日期归类的年月日命名的子文件夹内.
2.3 数据库设计
 
数据库表格设计图: 
更详细的见sql文件：SeqManager/docs/db/db-tables.png
建立表结构： SeqManager/docs/db/db_tables.sql
添加权限初始化数据：SeqManager/docs/db/wjl_auth.sql
添加超级管理员数据：INSERT INTO `wjl_manager` (`mg_id`, `mg_name`, `mg_pwd`, `mg_role_id`, `mg_time`, `mg_mod_time`, `condition`, `mg_uid`) VALUES (1, 'admin', '21232f297a57a5a743894a0e4a801fc3', 0, 1473501831, 1475049495, 1, 1);
添加角色信息：
INSERT INTO `wjl_role` (`role_id`, `role_name`, `role_auth_ids`, `role_auth_ac`, `auth_time`, `auth_mod_time`, `condition`, `role_uid`) VALUES (1, '教授', '1,11,12,14,15,13,16,2,17,18,20,21,19,22,3,23,25,26,68,24,27,4,28,30,31,29,32,34,35,33,5,36,38,39,37,40,42,43,41,6,44,46,47,65,67,45,8,57,58,59,9,60,61,10,62,63,64', 'Seq-showlist,Seq-detail,Seq-add,Seq-upd,Seq-del,Seq-search,Oligo-showlist,Oligo-detail,Oligo-add,Oligo-upd,Oligo-del,Oligo-search,File-showlist,File-add,File-upd,File-del,File-search,Cate-showlist,Cate-add,Cate-upd,Cate-del,Tag-showlist,Tag-add,Tag-upd,Tag-del,Fridge-showlist,Fridge-add,Fridge-upd,Fridge-del,Box-showlist,Box-add,Box-upd,Box-del,Manager-showlist,Manager-add,Manager-upd,Manager-del,Recycle-showlist,Recycle-restore,Recycle-delete,Search-index,Search-advSearch,Help-index,Help-article,Help-about,Manager-resetPwd,Manager-resetMyPwd,File-detail', 1473822930, 1473822931, 1, 1);
INSERT INTO `wjl_role` (`role_id`, `role_name`, `role_auth_ids`, `role_auth_ac`, `auth_time`, `auth_mod_time`, `condition`, `role_uid`) VALUES (2, '研究生', '1,11,12,14,15,13,16,2,17,18,20,21,19,22,3,23,25,26,68,24,27,4,28,30,31,29,32,34,35,33,5,36,40,42,43,41,67,8,57,58,59,9,60,61,10,62,63,64', 'Seq-showlist,Seq-detail,Seq-add,Seq-upd,Seq-del,Seq-search,Oligo-showlist,Oligo-detail,Oligo-add,Oligo-upd,Oligo-del,Oligo-search,File-showlist,File-add,File-upd,File-del,File-search,Cate-showlist,Cate-add,Cate-upd,Cate-del,Tag-showlist,Tag-add,Tag-upd,Tag-del,Fridge-showlist,Box-showlist,Box-add,Box-upd,Box-del,Recycle-showlist,Recycle-restore,Recycle-delete,Search-index,Search-advSearch,Help-index,Help-article,Help-about,Manager-resetMyPwd,File-detail', 1473822930, 1473822931, 1, 1);
INSERT INTO `wjl_role` (`role_id`, `role_name`, `role_auth_ids`, `role_auth_ac`, `auth_time`, `auth_mod_time`, `condition`, `role_uid`) VALUES (3, '本科生', '1,11,12,14,15,13,16,2,17,18,20,21,19,22,3,23,25,26,68,24,27,4,28,30,31,29,32,34,35,33,5,40,42,43,41,67,8,57,58,59,9,60,10,62,63,64', 'Seq-showlist,Seq-detail,Seq-add,Seq-upd,Seq-del,Seq-search,Oligo-showlist,Oligo-detail,Oligo-add,Oligo-upd,Oligo-del,Oligo-search,File-showlist,File-add,File-upd,File-del,File-search,Cate-showlist,Cate-add,Cate-upd,Cate-del,Tag-showlist,Tag-add,Tag-upd,Tag-del,Box-showlist,Box-add,Box-upd,Box-del,Recycle-showlist,Recycle-restore,Recycle-delete,Search-index,Help-index,Help-article,Help-about,Manager-resetMyPwd,File-detail', 1473822930, 1473822931, 1, 1);


2.4 数据库配置
SeqManager/Common/Conf/config.php中配置数据库信息：
<?php
return array(
    //页面调试开关
    //'SHOW_PAGE_TRACE' => true,
    
    //URL模式
    'URL_MODEL'=>2,

	//'配置项'=>'配置值'
	//PDO连接方式是默认的，已经无法设置了。http://www.kancloud.cn/manual/thinkphp/1731
    //数据库配置信息
    'DB_TYPE'   => 'mysql', // 数据库类型
    'DB_HOST'   => '127.0.0.1', // 服务器地址
    'DB_NAME'   => 'think', // 数据库名
    'DB_USER'   => 'root', // 用户名
    'DB_PWD'    => '', // 密码
    'DB_PORT'   => 3306, // 端口
    'DB_PARAMS' =>  array(), // 数据库连接参数
    'DB_PREFIX' => 'wjl_', // 数据库表前缀 
    'DB_CHARSET'=> 'utf8', // 字符集
    'DB_DEBUG'  =>  TRUE, // 数据库调试模式 开启后可以记录SQL日志
);


2.5 网址配置
鉴于该系统是为内部使用而设计的,这个可以
(1)	通过IP直接访问.
(2)	也可以设置虚拟网址,每个用户修改hosts文件访问;
(3)	或者设置虚拟网址,通过内部DNS解析访问.

建议使用第一种方式.
本例接下来使用的第二种方式,且设置的虚拟网址是http://seq.dawneve.cc 


 
三、超级管理员操作说明书
超级管理员仅仅用于首次设置系统，一般不建议此后再次使用。

3.1 首次登录
打开浏览器,在地址栏中输入http://seq.dawneve.cc/admin/manager/login并回车,看到登录界面,输入用户名和密码,点击登录,即可登录系统.
用户名：admin
密码：admin
 

登陆后的界面如下图：
 
3.2 查看管理员
点击左侧 – 用户管理 – 管理员列表：
 


3.3 添加管理员
点击左侧 – 用户管理 – 添加管理员：
 
填写信息，提交即可看到王二小已经被添加到管理员列表中。
 

再次点击添加用户,用户名”李老师”，密码为123456，角色为 教授，并点击确定。
3.4 查看权限
点击左侧 – 系统管理 – 权限列表：
 

权限列表是为开发人员使用的，不建议普通用户操作该条目，但可以查看。

3.5 查看角色
点击左侧 – 系统管理 – 角色列表：
 
3.6 分配权限
在查看角色视图中，点击右侧角色后面的 分配权限， 即可调整不同角色的权限：
 
一般不建议操作该部分。
3.7 添加权限
点击左侧 – 系统管理 – 添加角色：
 
点击提交之后，会进入分配权限界面。截图略。
3.8 退出系统
点击顶部中间的“退出系统”，在弹出的确认退出提示中单击确定，即可退出本次登录。
 
四、教授角色操作说明书
教授用户也有用户管理的权限，如果其他用户密码丢失，可以请教授重置密码。
此外，教授还能够添加、删除、修改冰箱信息。

4.1教授用户登录
退出系统后，使用上文已经添加了教授新用户重新登录：
用户名：李老师
密码： 刚才设置的密码。
登录结果如下：
 
4.2 添加用户
点击左侧 – 用户管理 – 添加管理员：
填写名字、密码，设置角色，点击提交即可添加新用户。
 
之后自动跳转到管理员列表页，如下图：
 

4.3 重置用户密码
或者点击左侧 – 用户管理 –管理员列表，也就是上个视图中，点击用户名右侧的 重置密码，即可进入重置密码页面：
 
先输入当前管理员密码，再输入为该用户重置的密码，提交即可重置用户密码。

4.4 添加冰箱
点击左侧 - 位置管理 – 添加冰箱，填写冰箱名字、位置、备注信息，点击提交，即可添加冰箱。教授添加的冰箱所有用户可见。
 





 
五、研究生角色操作说明书

5.1 研究生登录
退出系统后，使用上文已经添加了研究生新用户重新登录：
用户名：王小二
密码： 刚才设置的密码。
登录结果如下：
 
研究生角色没有用户管理功能，能查看冰箱，不能增加、修改冰箱。

5.2 添加盒子
使用系统第一步是添加盒子，也可以使用增加新用户时系统添加的 “默认盒子”。
点击左侧 - 位置管理 – 添加盒子，填写盒子信息，选择冰箱，提交后即可添加一个盒子。
 
添加后的盒子会出现在盒子列表页面中：
 

5.3 添加分类
分类十分有益于大量样本的索引、查找，每个引物或DNA样本有且只能有一个分类。
点击左侧 – 类别管理 – 添加分类，填写一个中文或英文分类，不要有空格，如下图：
 
提交后跳转到分类列表中：
 
该界面还可以修改或删除分类。

5.4 添加标签
标签也十分有益于大量样本的索引、查找，每个引物或DNA样本可以有0-5个标签。
点击左侧 – 类别管理 – 添加标签，填写一个中文或英文标签，不要有空格，如下图：


 
提交后跳转到标签列表中：
 
该界面还可以修改或删除标签。


5.5 添加引物
有了盒子就可以添加引物了，点击左侧 – 引物管理 – 添加引物，
 
可以添加0个到多个附件，比如引物设计参考资料等。
可以选择或添加至多5个标签。

提交后跳转到引物列表页面中：
 

5.6 按照分类和标签索引引物
多添加几条引物，分别使用不同的标签。
 
点击标签up，即可按照标签up索引引物：
 

点击分类默认分类，即可按照该分类索引引物：
 
5.7 添加测序结果
点击左侧 – 测序管理 – 添加测序信息，填写测序相关信息，选择类别信息，位置信息，提交，即可添加一条测序结果信息。
 
可以添加0个到多个附件，比如蛋白相关背景资料、测序原始图谱、具体的分析文件等。
可以选择或添加至多5个标签。

点击提交后即可看到测序列表页面：
 
5.8 按照分类和标签索引测序结果
使用方法和5.6相同。
5.9 添加文件
（1）上传非附件文件：
点击 左侧 – 文件管理 – 添加文件，上传文件。
如果没有填写文件名称，则使用原始文件名作为文件名。
也支持添加分类和标签。
提交后进入文件列表页面：
 

（2）也可以以附件形式上传文件：
 1) 测序管理->添加测序信息 或者; 2) 引物管理->添加引物信息 的添加附件 中上传文件。

5.10 搜索
搜索是现代信息管理系统必备组件，本系统也实现了方便的搜索功能，目前仅支持单个关键词的搜索。

5.10.1 搜索入口
共有三种入口可以进入搜索界面：
(1)在页面顶部中间点击“我的搜索”；
(2)在页面左侧测序管理、引物管理、文件管理中点击搜索xx即可；
(3)点击左侧搜索中的我的搜索即可；
 

5.10.2 搜索方法
进行搜索只需要四步：
（1）设置索引方式：点击按分类索引、按标签索引、按关键词搜索、按序列搜索中的一个。
（2）设置搜索目标：分别是测序信息、引物信息和文件信息。
（3）输入关键词；
（4）点击搜索按钮。
5.10.3按照关键词搜索
默认是按照关键词搜索测序结果，就是找到名字和备注中有关键词的条目并显示出来。
比如我们输入xx并回车，返回3条测序结果信息。
 

5.10.3 按照分类索引
就是查找分类名字中和关键词匹配的条目。
比如查找phage，就出现如下条目：
 


5.10.4 按照标签索引
就是查找标签名字中和关键词匹配的条目。
例子略。

5.10.5 按照序列搜索
如果想查找特殊序列，可以使用该选项，序列搜索只能在测序信息和引物信息中搜索。
比如想搜索含有‘tcc’的序列，结果如下：
 
5.11 修改自己的密码
用户如果想修改自己的密码，可以点击顶部中间的“修改口令”，输入旧密码后就可以设置新密码了，点击提交既可。
 

5.12 回收站
为了防止用户不小心删除，本系统实现了回收站功能。
用户删除的条目会先回到回收站，在回收站内可以彻底删除，或者反悔恢复。

（1）点击左侧的回收站 – 回收站列表，可以看到回收站列表页面：
 
上图可见回收站内有4个引物，有7个文件。
（2）点击file右侧的全部显示，进入file回收站明细页面：
 
该页面可以根据标题、日期等选择还原条目或者彻底删除。

